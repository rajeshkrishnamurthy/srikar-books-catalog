{"type":"fail","test":"tests/spec/admin/SBD-F24-TP4-001_AutoRecommendationFiresOnSecondSelection.spec.js"}
{"type":"fail","test":"tests/spec/admin/SBD-F24-TP4-002_FormattedPricingTextUpdates.spec.js"}
{"type":"fail","test":"tests/spec/admin/SBD-F24-TP4-003_TotalMrpSummedAndAnnounced.spec.js"}
{"type":"fail","test":"tests/spec/admin/SBD-F24-TP4-004_TotalMrpFallbackWhenMissing.spec.js"}
{"type":"spec","id":"SBD-F24-TP4-001","given":"The inline bundle composer drawer is open with INR currency and pricing summary elements visible.","when":"A first book is added and then a second book is added to the selection (meeting the default threshold).","then":"fetchPriceRecommendation fires once automatically with both selected bookIds and currency without requiring an extra click."}
{"type":"spec","id":"SBD-F24-TP4-002","given":"At least two books are selected and the recommendation adapter returns recommendedPriceMinor and totalSalePriceMinor.","when":"The recommendation promise resolves.","then":"The Recommended price and Total sale price fields swap placeholder copy for formatPrice outputs that reflect the returned minor-unit values."}
{"type":"spec","id":"SBD-F24-TP4-003","given":"Selected books include mrpMinor metadata and the composer pricing summary is visible.","when":"Recommendation results are processed after selection changes.","then":"The composer renders a Total MRP value derived from the mrpMinor sum (or adapter payload), formats it with formatPrice, and calls announce with a message that includes the updated total."}
{"type":"spec","id":"SBD-F24-TP4-004","given":"A selection is present but one or more books do not have mrpMinor data.","when":"The pricing summary updates after the recommendation call.","then":"The Total MRP block shows placeholder/fallback copy (without currency digits) and the announce adapter communicates that MRP is unavailable for aria-live feedback."}
{"type":"reuse","patternId":"INLINE_BUNDLE_COMPOSER"}
{"type":"pattern","patternId":"INLINE_BUNDLE_COMPOSER","requiredParams":["container","panelHeading","triggerSelector","bookList","bundleNameInput","bundlePriceInput","recommendedPrice","totalPrice","saveButton","currency"],"adapters":{"fetchPriceRecommendation":"({ bookIds: string[], currency: string }) => Promise<{ recommendedPriceMinor: number, totalSalePriceMinor: number }>","loadBundle":"(bundleId: string) => Promise<{ bundleName: string, bundlePriceMinor: number, bookIds: string[] }>","listExistingBundles":"() => Promise<{ id: string, name: string, bookCount: number }[]>","saveBundle":"(payload: { bundleName: string, bundlePriceMinor: number, bookIds: string[], bundleId?: string }) => Promise<{ bundleId: string }>","linkBooks":"(bundleId: string, bookIds: string[]) => Promise<void>","formatPrice":"(valueInMinorUnits: number, currency: string) => string","toastSuccess":"(message: string, options?: Record<string,any>) => void","toastError":"(message: string, options?: Record<string,any>) => void","announce":"(message: string) => void"},"testBehaviors":["Recommendation adapter auto-fires once selection count meets the threshold and streams formatted recommended/total prices plus total MRP to the shell."]}
