{"type":"meta","topicId":"SBD-F24-TP3","title":"Inline Bundle Validation Gate"}
{"type":"given","text":"The composer holds a bundle context."}
{"type":"when","text":"The admin edits name or price fields."}
{"type":"then","text":"Validation trims input, enforces non-empty names plus positive currency values, feeds field errors to the shell, and only enables Save when both pass."}
{"type":"reuse","patternId":"INLINE_BUNDLE_PANEL_SHELL"}
{"type":"reuse","patternId":"INLINE_BUNDLE_COMPOSER_CONTROLLER"}
{"type":"ui-anchor","selector":"#inlineBundleComposer"}
{"type":"ui-anchor","selector":"#inlineBundleHeading"}
{"type":"ui-anchor","selector":"[data-test=\"bookAddToBundle\"]"}
{"type":"ui-anchor","selector":"#inlineBundleSelectedBooks"}
{"type":"ui-anchor","selector":"#inlineBundleName"}
{"type":"ui-anchor","selector":"#inlineBundlePrice"}
{"type":"ui-anchor","selector":"#inlineBundleRecommended"}
{"type":"ui-anchor","selector":"#inlineBundleTotal"}
{"type":"ui-anchor","selector":"#inlineBundleSave"}
{"type":"ui-anchor","selector":"#inlineBundleReset"}
{"type":"ui-anchor","selector":"#inlineBundleMrp"}
{"type":"js-handler","event":"click","selector":"[data-test=\"bookAddToBundle\"]","handler":"openInlineBundleComposer"}
{"type":"js-handler","event":"click","selector":"#inlineBundleReset","handler":"resetInlineBundle"}
{"type":"js-handler","event":"click","selector":"#inlineBundleSave","handler":"saveInlineBundleDraft"}
{"type":"js-handler","event":"input","selector":"#inlineBundleName","handler":"updateInlineBundleFields"}
{"type":"js-handler","event":"input","selector":"#inlineBundlePrice","handler":"updateInlineBundleFields"}
{"type":"adapter-call","function":"createInlineBundleComposerController","args":[]}
{"type":"adapter-call","function":"formatCurrency","args":["value","currency"]}
{"type":"adapter-call","function":"announceInlineBundleChange","args":["message"]}
{"type":"adapter-call","function":"fetchBundlePriceRecommendation","args":["bookIds","currency"]}
{"type":"adapter-call","function":"loadBundleDraftFromSession","args":[]}
{"type":"adapter-call","function":"persistNewBundle","args":["bundleData"]}
{"type":"adapter-call","function":"syncInlineBundlePanelState","args":["state"]}
{"type":"pattern","patternId":"INLINE_BUNDLE_PANEL_SHELL","requiredParams":["container","panelHeading","triggerSelector","bookList","bundleNameInput","bundlePriceInput","recommendedPrice","totalPrice","saveButton","resetButton"],"adapters":{"controller":"createInlineBundleComposerController","formatPrice":"formatCurrency","announce":"announceInlineBundleChange"},"testBehaviors":[]}
{"type":"pattern","patternId":"INLINE_BUNDLE_COMPOSER_CONTROLLER","requiredParams":["currency","pricePrecision","recommendationThreshold"],"adapters":{"fetchPriceRecommendation":"fetchBundlePriceRecommendation","loadBundle":"loadBundleDraftFromSession","saveBundle":"persistNewBundle","onStateChange":"syncInlineBundlePanelState"},"testBehaviors":[]}
