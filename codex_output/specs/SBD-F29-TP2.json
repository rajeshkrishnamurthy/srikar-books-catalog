{
  "topicId": "SBD-F29-TP2",
  "featureId": "F29",
  "title": "Books Available Floating Bundle Trigger",
  "area": "Admin / Manage Books - Available",
  "goal": "Apply the floating trigger to Manage Books → Available so the bundle drawer can be opened from anywhere.",
  "environment": "HTML + Vanilla JavaScript + Jest + jsdom",
  "status": "GREEN",
  "specs": [
    {
      "id": "SBD-F29-TP2-001",
      "title": "ManageBooksMarkupExposesFloatingTrigger",
      "given": "Manage Books → Available markup renders alongside the inline bundle composer drawer.",
      "when": "The admin.html DOM is parsed.",
      "then": "#bundleFloatingTrigger and #bundleFloatingBadge exist, point to #inlineBundleComposer, and start hidden with an empty badge until a selection exists."
    },
    {
      "id": "SBD-F29-TP2-002",
      "title": "FloatingTriggerVisibleWithBundleCount",
      "given": "Inline bundle composer anchors and floating trigger selectors are present.",
      "when": "One or more books are added to a bundle (or a resumed session reports a positive count).",
      "then": "The floating trigger becomes visible with fixed bottom-right positioning and its badge reflects the bundle count capped to two digits (e.g., 99+)."
    },
    {
      "id": "SBD-F29-TP2-003",
      "title": "FloatingTriggerHiddenWhenSelectionCleared",
      "given": "The floating trigger was visible for a non-zero bundle selection.",
      "when": "The inline bundle composer is reset so the selection count returns to zero.",
      "then": "#bundleFloatingTrigger hides entirely and the badge text clears so no empty-state badge is announced."
    }
  ],
  "fixtures": [
    "/tests/fixtures/adminInventoryHarness.js"
  ],
  "tests": [
    "/tests/spec/admin/SBD-F29-TP2-001_AdminHtmlHasFloatingBundleTrigger.spec.js",
    "/tests/spec/admin/SBD-F29-TP2-002_FloatingTriggerShowsWithBundleCount.spec.js",
    "/tests/spec/admin/SBD-F29-TP2-003_FloatingTriggerHidesWhenSelectionCleared.spec.js"
  ],
  "reports": {
    "red": "codex_output/reports/SBD-F29-TP2_red.txt",
    "green": "codex_output/reports/SBD-F29-TP2_green.txt"
  ],
  "changedFiles": [
    "tests/spec/admin/SBD-F29-TP2-001_AdminHtmlHasFloatingBundleTrigger.spec.js",
    "tests/spec/admin/SBD-F29-TP2-002_FloatingTriggerShowsWithBundleCount.spec.js",
    "tests/spec/admin/SBD-F29-TP2-003_FloatingTriggerHidesWhenSelectionCleared.spec.js",
    "codex_output/specs/SBD-F29-TP2.json",
    "codex_output/impl_inputs/SBD-F29-TP2.jsonl",
    "codex_output/reports/SBD-F29-TP2_red.txt",
    "codex_output/reports/SBD-F29-TP2_green.txt",
    "admin.html",
    "scripts/admin/inventory.js",
    "src/ui/patterns/floating-drawer-trigger/index.js"
  ],
  "changeNotes": [
    "Authored three RED specs for the Manage Books floating bundle trigger covering anchor presence, positive-count visibility with capped badge text, and zero-state hiding.",
    "Tests mount the admin inventory harness (parsing admin.html) to ensure the trigger hooks into inline bundle composer state.",
    "Implemented floating bundle trigger markup plus inventory wiring that mirrors the floating drawer trigger pattern, including hidden add proxies so badge counts reflect full selections."
  ],
  "validation": {
    "status": "GREEN",
    "command": "npm test -- --watchAll=false SBD-F29-TP2",
    "report": "codex_output/reports/SBD-F29-TP2_green.txt"
  }
}
